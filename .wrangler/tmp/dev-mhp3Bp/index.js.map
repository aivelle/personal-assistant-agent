{
  "version": 3,
  "sources": ["../../../src/utils/logger.js", "../../../src/workflows/automation/voice_to_anywhere.js", "../../../src/workflows/automation/attach_image_to_any_post.js", "../../../src/workflows/automation/content_repurpose.js", "../../../src/workflows/automation/reschedule_meeting.js", "../../../src/workflows/automation/daily_intent_digest.js", "../../../src/workflows/automation/auto_tagging.js", "../../../src/workflows/automation/auto_reply.js", "../../../src/workflow-engine.js", "../../../configs/prompt-router.json", "../../../src/utils/getIntentFromPrompt.js", "../../../src/utils/oauth.js", "../../../src/oauth/google.js", "../../../src/oauth/notion.js", "../../../src/index.js", "../../../../../../../usr/local/lib/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../bundle-IjqVcK/middleware-insertion-facade.js", "../../../../../../../usr/local/lib/node_modules/wrangler/templates/middleware/common.ts", "../bundle-IjqVcK/middleware-loader.entry.ts"],
  "sourceRoot": "/Users/kaminchung/Documents/ personal_assistant_agent/.wrangler/tmp/dev-mhp3Bp",
  "sourcesContent": ["const LOG_LEVELS = {\n  DEBUG: 0,\n  INFO: 1,\n  WARN: 2,\n  ERROR: 3,\n  FATAL: 4\n};\n\nconst LOG_COLORS = {\n  DEBUG: '\\x1b[36m', // \uCCAD\uB85D\uC0C9\n  INFO: '\\x1b[32m',  // \uB179\uC0C9\n  WARN: '\\x1b[33m',  // \uB178\uB780\uC0C9\n  ERROR: '\\x1b[31m', // \uBE68\uAC04\uC0C9\n  FATAL: '\\x1b[35m', // \uBCF4\uB77C\uC0C9\n  RESET: '\\x1b[0m'   // \uB9AC\uC14B\n};\n\nclass Logger {\n  constructor() {\n    this.logLevel = LOG_LEVELS.INFO;\n    this.isDevelopment = false; // Cloudflare Workers\uC5D0\uC11C\uB294 \uD56D\uC0C1 false\n  }\n\n  setLogLevel(level) {\n    if (LOG_LEVELS[level] !== undefined) {\n      this.logLevel = LOG_LEVELS[level];\n    }\n  }\n\n  formatMessage(level, message, meta = {}) {\n    const timestamp = new Date().toISOString();\n    const requestId = meta.requestId || 'NO_REQUEST_ID';\n    const userId = meta.userId || 'NO_USER';\n    \n    return {\n      timestamp,\n      level,\n      requestId,\n      userId,\n      message,\n      ...meta\n    };\n  }\n\n  shouldLog(level) {\n    return LOG_LEVELS[level] >= this.logLevel;\n  }\n\n  log(level, message, meta = {}) {\n    if (!this.shouldLog(level)) return;\n\n    const formattedLog = this.formatMessage(level, message, meta);\n    \n    // Cloudflare Workers\uC5D0\uC11C\uB294 \uD56D\uC0C1 JSON \uD615\uC2DD\uC73C\uB85C \uCD9C\uB825\n    console.log(JSON.stringify(formattedLog));\n  }\n\n  debug(message, meta = {}) {\n    this.log('DEBUG', message, meta);\n  }\n\n  info(message, meta = {}) {\n    this.log('INFO', message, meta);\n  }\n\n  warn(message, meta = {}) {\n    this.log('WARN', message, meta);\n  }\n\n  error(message, meta = {}) {\n    this.log('ERROR', message, meta);\n  }\n\n  fatal(message, meta = {}) {\n    this.log('FATAL', message, meta);\n  }\n\n  // OAuth \uC804\uC6A9 \uB85C\uAE45 \uBA54\uC18C\uB4DC\n  oauthLog(status, message, meta = {}) {\n    const level = status === 'success' ? 'INFO' : 'ERROR';\n    this.log(level, `[OAuth] ${message}`, {\n      ...meta,\n      oauth_status: status\n    });\n  }\n\n  // API \uC694\uCCAD \uB85C\uAE45\n  apiRequest(method, path, meta = {}) {\n    this.info(`API Request: ${method} ${path}`, {\n      ...meta,\n      http_method: method,\n      path\n    });\n  }\n\n  // \uC131\uB2A5 \uBA54\uD2B8\uB9AD \uB85C\uAE45\n  logMetric(name, value, meta = {}) {\n    this.info(`Metric: ${name} = ${value}`, {\n      ...meta,\n      metric_name: name,\n      metric_value: value\n    });\n  }\n}\n\n// \uC2F1\uAE00\uD1A4 \uC778\uC2A4\uD134\uC2A4 \uC0DD\uC131\nconst logger = new Logger();\n\nexport default logger; ", "/**\n * Handles the \"voice_to_anywhere\" intent\n * @param {object} param\n * @param {string} param.prompt\n * @param {object} param.context\n * @returns {object}\n */\nexport async function run({ prompt, context }) {\n  // Actual processing logic\n  return {\n    message: \"Voice-based idea recorded\",\n    note: prompt,\n    target: \"Notion (or elsewhere)\",\n  };\n} ", "/**\n * Handles the \"attach_image_to_any_post\" intent\n * @param {object} param\n * @param {string} param.prompt\n * @param {object} param.context\n * @returns {object}\n */\nexport async function run({ prompt, context }) {\n  // Actual processing logic\n  return {\n    message: \"Image attached to post (mock)\",\n    prompt,\n    target: \"Social Media Post (or elsewhere)\",\n  };\n} ", "/**\n * Handles the \"content_repurpose\" intent\n * @param {object} param\n * @param {string} param.prompt\n * @param {object} param.context\n * @returns {object}\n */\nexport async function run({ prompt, context }) {\n  // Actual processing logic\n  return {\n    message: \"Content repurposed (mock)\",\n    prompt,\n    target: \"Repurposed Content (e.g., LinkedIn, Blog)\",\n  };\n} ", "/**\n * Handles the \"reschedule_meeting\" intent\n * @param {object} param\n * @param {string} param.prompt\n * @param {object} param.context\n * @returns {object}\n */\nexport async function run({ prompt, context }) {\n  // Actual processing logic\n  return {\n    message: \"Meeting rescheduled (mock)\",\n    prompt,\n    target: \"Calendar/Meeting App (or elsewhere)\",\n  };\n} ", "/**\n * Handles the \"daily_intent_digest\" intent\n * @param {object} param\n * @param {string} param.prompt\n * @param {object} param.context\n * @returns {object}\n */\nexport async function run({ prompt, context }) {\n  // Actual processing logic\n  return {\n    message: \"Daily digest generated (mock)\",\n    prompt,\n    target: \"Digest/Notification (or elsewhere)\",\n  };\n} ", "/**\n * @intent auto_tagging\n * @description Automatically tag items based on user input or content.\n * @example \"Automatically tag all new notes with #meeting\"\n */\nexport async function run({ prompt, context }) {\n  // TODO: Implement auto-tagging logic\n  return {\n    message: \"Auto-tagging completed (mock)\",\n    prompt,\n  };\n} ", "/**\n * @intent auto_reply\n * @description Automatically reply to messages or comments based on user rules.\n * @example \"Auto-reply to all emails with 'Thank you for your message'\"\n */\nexport async function run({ prompt, context }) {\n  // TODO: Implement auto-reply logic\n  return {\n    message: \"Auto-reply sent (mock)\",\n    prompt,\n  };\n} ", "// src/workflow-engine.js\n\nimport logger from \"./utils/logger.js\";\nimport * as voiceToAnywhere from \"./workflows/automation/voice_to_anywhere.js\";\nimport * as attachImageToAnyPost from \"./workflows/automation/attach_image_to_any_post.js\";\nimport * as contentRepurpose from \"./workflows/automation/content_repurpose.js\";\nimport * as rescheduleMeeting from \"./workflows/automation/reschedule_meeting.js\";\nimport * as dailyIntentDigest from \"./workflows/automation/daily_intent_digest.js\";\nimport * as autoTagging from \"./workflows/automation/auto_tagging.js\";\nimport * as autoReply from \"./workflows/automation/auto_reply.js\";\n// NOTE: These imports can be auto-generated by a build script in the future.\n\nconst workflows = {\n  voice_to_anywhere: voiceToAnywhere,\n  attach_image_to_any_post: attachImageToAnyPost,\n  content_repurpose: contentRepurpose,\n  reschedule_meeting: rescheduleMeeting,\n  daily_intent_digest: dailyIntentDigest,\n  auto_tagging: autoTagging,\n  auto_reply: autoReply,\n};\n\n/**\n * Runs the workflow for the given intent\n * @param {string} intent - The intent name\n * @param {string} prompt - The original user prompt\n * @param {object} [context={}] - Optional context\n * @returns {Promise<object>} - Result of the workflow\n */\nexport async function runWorkflow(intent, prompt, context = {}) {\n  const workflow = workflows[intent];\n  if (!workflow || !workflow.run) {\n    logger.error(`No workflow found for intent: ${intent}`);\n    return {\n      success: false,\n      message: `\u274C No workflow found for intent: ${intent}`,\n    };\n  }\n\n  try {\n    logger.info(`Running workflow for intent: ${intent}`);\n    const result = await workflow.run({ prompt, context });\n    return {\n      success: true,\n      intent,\n      prompt,\n      result,\n    };\n  } catch (err) {\n    logger.error(`Error running workflow for intent ${intent}:`, err);\n    return {\n      success: false,\n      message: `\u274C Error running workflow: ${err.message}`,\n    };\n  }\n}\n\nexport { workflows }; ", "{\n  \"_meta\": {\n    \"description\": \"Prompt routing configuration for AI agent. Map user prompt types or intents to specific workflows or response strategies.\"\n  },\n  \"routes\": [\n    {\n      \"intent\": \"voice_to_anywhere\",\n      \"workflow\": \"voice_to_anywhere\"\n    },\n    {\n      \"intent\": \"attach_image\",\n      \"workflow\": \"attach_image_to_any_post\"\n    },\n    {\n      \"intent\": \"repurpose_content\",\n      \"workflow\": \"content_repurpose\"\n    },\n    {\n      \"intent\": \"reschedule_meeting\",\n      \"workflow\": \"reschedule_meeting\"\n    },\n    {\n      \"intent\": \"daily_digest\",\n      \"workflow\": \"daily_intent_digest\"\n    }\n  ]\n} ", "// src/utils/getIntentFromPrompt.js\n// Returns the intent name based on the user's prompt using hardcoded keyword rules (Korean + English)\n\n/**\n * Maps a user prompt to an intent using hardcoded keyword rules (Korean and English).\n * @param {string} prompt - The user input\n * @returns {string|null} - The intent name if matched, else null\n */\nexport function getIntentFromPrompt(prompt) {\n  const lowered = prompt.toLowerCase();\n\n  if (prompt.includes(\"\uC815\uB9AC\") || prompt.includes(\"\uC694\uC57D\") ||\n      lowered.includes(\"summarize\") || lowered.includes(\"summary\")) {\n    return \"daily_intent_digest\";\n  }\n\n  if ((prompt.includes(\"\uC774\uBBF8\uC9C0\") && prompt.includes(\"\uBD99\uC5EC\")) ||\n      (lowered.includes(\"image\") && (lowered.includes(\"attach\") || lowered.includes(\"add\")))) {\n    return \"attach_image_to_any_post\";\n  }\n\n  if ((prompt.includes(\"\uD68C\uC758\") && prompt.includes(\"\uBCC0\uACBD\")) ||\n      (lowered.includes(\"meeting\") && (lowered.includes(\"reschedule\") || lowered.includes(\"change\")))) {\n    return \"reschedule_meeting\";\n  }\n\n  if (\n    prompt.includes(\"\uAE30\uB85D\") ||\n    prompt.includes(\"\uC544\uC774\uB514\uC5B4\") ||\n    prompt.includes(\"\uC74C\uC131\") ||\n    lowered.includes(\"record\") ||\n    lowered.includes(\"idea\") ||\n    lowered.includes(\"voice\")\n  ) {\n    return \"voice_to_anywhere\";\n  }\n\n  return null;\n}\n", "// src/utils/oauth.js\n\n// Cloudflare Workers \uD658\uACBD\uC5D0\uC11C\uB294 KV \uB124\uC784\uC2A4\uD398\uC774\uC2A4\uB97C \uC0AC\uC6A9\uD574\uC57C \uD569\uB2C8\uB2E4.\n// wrangler.toml\uC5D0 \uB2E4\uC74C\uACFC \uAC19\uC774 \uBC14\uC778\uB529 \uD544\uC694:\n// [[kv_namespaces]]\n// binding = \"USERS_KV\"\n// id = \"...\"\n\n/**\n * OAuth \uC0C1\uD0DC \uAD00\uB9AC \uBC0F \uC720\uD2F8\uB9AC\uD2F0 \uD568\uC218\n */\n\nconst STATE_PREFIX = 'oauth_state_';\nconst USER_PREFIX = 'oauth_user_';\nconst STATE_EXPIRY = 60 * 5; // 5 minutes in seconds\n\n/**\n * Utility function for KV JSON operations\n */\nasync function kvJSON(operation, env, key, value = null, options = {}) {\n  switch (operation) {\n    case 'get':\n      const data = await env.USERS_KV.get(key);\n      return data ? JSON.parse(data) : null;\n    case 'put':\n      await env.USERS_KV.put(key, JSON.stringify(value), options);\n      return true;\n    default:\n      throw new Error(`Unknown KV operation: ${operation}`);\n  }\n}\n\n/**\n * OAuth \uC0C1\uD0DC \uC800\uC7A5\n */\nexport async function saveOAuthState(state, env) {\n  const key = `${STATE_PREFIX}${state}`;\n  return kvJSON('put', env, key, {\n    created: Date.now()\n  }, {\n    expirationTtl: STATE_EXPIRY\n  });\n}\n\n/**\n * OAuth \uC0C1\uD0DC \uAC80\uC99D - Atomic Operation\n */\nexport async function verifyOAuthState(state, env) {\n  if (!state) return false;\n  \n  const key = `${STATE_PREFIX}${state}`;\n  \n  // Atomic operation using KV's atomic read-delete\n  try {\n    const stored = await env.USERS_KV.getWithMetadata(key);\n    if (!stored.value) return false;\n    \n    // Delete the state token immediately after reading\n    await env.USERS_KV.delete(key);\n    return true;\n  } catch (error) {\n    console.error('Error during atomic state verification:', error);\n    return false;\n  }\n}\n\n/**\n * OAuth \uC0AC\uC6A9\uC790 \uB370\uC774\uD130 \uC800\uC7A5\n */\nexport async function saveUserOAuthData(userId, data, env) {\n  const key = `${USER_PREFIX}${userId}`;\n  return kvJSON('put', env, key, {\n    ...data,\n    updated: Date.now()\n  });\n}\n\n/**\n * OAuth \uC5D0\uB7EC \uC751\uB2F5 \uC0DD\uC131\n */\nexport function createOAuthErrorResponse(message, status = 400) {\n  const html = `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <title>Authentication Error</title>\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <style>\n          body {\n            font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            min-height: 100vh;\n            margin: 0;\n            background-color: #f5f5f5;\n          }\n          .container {\n            text-align: center;\n            padding: 2rem;\n            background: white;\n            border-radius: 8px;\n            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n          }\n          h1 {\n            color: #d32f2f;\n            margin-bottom: 1rem;\n          }\n          .message {\n            color: #666;\n            margin-bottom: 2rem;\n          }\n          .button {\n            display: inline-block;\n            background-color: #4285f4;\n            color: white;\n            padding: 12px 24px;\n            border-radius: 4px;\n            text-decoration: none;\n            font-weight: 500;\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"container\">\n          <h1>Authentication Error</h1>\n          <p class=\"message\">${message}</p>\n          <a href=\"/oauth/google\" class=\"button\">Try Again</a>\n        </div>\n      </body>\n    </html>\n  `;\n\n  return new Response(html, {\n    status,\n    headers: { 'Content-Type': 'text/html;charset=UTF-8' },\n  });\n}\n\n/**\n * OAuth \uC131\uACF5 \uC751\uB2F5 \uC0DD\uC131\n */\nexport function createOAuthSuccessResponse(message = 'Authentication successful!') {\n  const html = `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <title>Authentication Success</title>\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <style>\n          body {\n            font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            min-height: 100vh;\n            margin: 0;\n            background-color: #f5f5f5;\n          }\n          .container {\n            text-align: center;\n            padding: 2rem;\n            background: white;\n            border-radius: 8px;\n            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n          }\n          h1 {\n            color: #43a047;\n            margin-bottom: 1rem;\n          }\n          .message {\n            color: #666;\n            margin-bottom: 2rem;\n          }\n          .button {\n            display: inline-block;\n            background-color: #43a047;\n            color: white;\n            padding: 12px 24px;\n            border-radius: 4px;\n            text-decoration: none;\n            font-weight: 500;\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"container\">\n          <h1>Success!</h1>\n          <p class=\"message\">${message}</p>\n          <a href=\"/\" class=\"button\">Continue</a>\n        </div>\n      </body>\n    </html>\n  `;\n\n  return new Response(html, {\n    status: 200,\n    headers: { 'Content-Type': 'text/html;charset=UTF-8' },\n  });\n}\n\n/**\n * \uC0AC\uC6A9\uC790 \uC815\uBCF4 \uBD88\uB7EC\uC624\uAE30\n */\nexport async function getUserOAuthData(userId, env) {\n  const key = `${USER_PREFIX}${userId}`;\n  return kvJSON('get', env, key);\n}\n\n// (\uB85C\uCEEC \uAC1C\uBC1C\uC6A9 \uD30C\uC77C \uAE30\uBC18 \uC608\uC2DC\uB294 \uC8FC\uC11D \uCC98\uB9AC)\n// import fs from 'fs/promises';\n// const USERS_PATH = './configs/users.json';\n// ... \uAE30\uC874 \uD30C\uC77C \uAE30\uBC18 \uD568\uC218 ... ", "/**\n * Google OAuth \uC778\uC99D \uB9AC\uB514\uB809\uC158 \uC5D4\uB4DC\uD3EC\uC778\uD2B8\n * GET /oauth/google\n */\nimport { saveOAuthState, verifyOAuthState, saveUserOAuthData, createOAuthErrorResponse, createOAuthSuccessResponse } from '../utils/oauth.js';\nimport logger from '../utils/logger.js';\n\nexport async function handleGoogleOAuthRequest(request, env, responseHeaders = {}) {\n  // \u2705 I: Input \u2192 \uC0AC\uC6A9\uC790 \uC694\uCCAD \uAC10\uC9C0 \uBC0F \uBA54\uD0C0 \uCCB4\uD06C\n  const headers = request.headers;\n  const userAgent = headers.get(\"User-Agent\") || \"\";\n  const requestId = headers.get(\"X-Request-ID\") || crypto.randomUUID();\n  const referer = headers.get(\"Referer\") || \"\";\n  const clientIp = headers.get(\"CF-Connecting-IP\") || \"\";\n\n  // \uAE30\uBCF8 \uBA54\uD0C0\uB370\uC774\uD130\n  const meta = {\n    requestId,\n    clientIp,\n    userAgent,\n    referer\n  };\n\n  // \uB8E8\uD504 \uC704\uD5D8 \uD310\uB2E8\n  if (referer.includes(\"aivelle.com\") || userAgent.includes(\"Aivelle-Agent\")) {\n    logger.warn(\"Loop detected in Google OAuth request\", {\n      ...meta,\n      reason: \"loop_detected\"\n    });\n    return new Response(\"Loop detected and blocked\", { \n      status: 429,\n      headers: {\n        \"X-Error-Type\": \"loop_detected\",\n        \"Retry-After\": \"60\"\n      }\n    });\n  }\n\n  // \u2705 V: Validate \u2192 \uC694\uCCAD \uAE4A\uC774, \uBC18\uBCF5 \uC5EC\uBD80 \uAC80\uC0AC\n  const depth = Number(headers.get(\"X-Depth\") || \"0\");\n  if (depth > 3) {\n    logger.warn(\"Request depth exceeded in Google OAuth\", {\n      ...meta,\n      depth,\n      reason: \"depth_exceeded\"\n    });\n    return new Response(\"Request depth limit exceeded\", { \n      status: 400,\n      headers: { \"X-Error-Type\": \"depth_exceeded\" }\n    });\n  }\n\n  // \u2705 L: Log & Launch \u2192 \uC694\uCCAD \uAE30\uB85D\n  logger.apiRequest(\"GET\", \"/oauth/google\", meta);\n\n  // \uC2E4\uC81C OAuth \uCC98\uB9AC \uB85C\uC9C1\n  const clientId = env.GOOGLE_CLIENT_ID;\n  if (!clientId) {\n    logger.error(\"Google OAuth client ID is not configured\", meta);\n    return createOAuthErrorResponse('Google OAuth client ID is not configured', 500);\n  }\n\n  const url = new URL(request.url);\n  const baseUrl = `${url.protocol}//${url.host}`;\n  const redirectUri = `${baseUrl}/oauth/google/callback`;\n  const scope = encodeURIComponent('https://www.googleapis.com/auth/calendar https://www.googleapis.com/auth/userinfo.email');\n  \n  // Generate and save state for CSRF protection\n  const state = crypto.randomUUID();\n  await saveOAuthState(state, env);\n  \n  const authUrl = `https://accounts.google.com/o/oauth2/v2/auth?response_type=code&client_id=${clientId}&redirect_uri=${encodeURIComponent(redirectUri)}&scope=${scope}&state=${state}&access_type=offline&prompt=consent`;\n  \n  // Return HTML response with tracking headers\n  const html = `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <title>Google OAuth Authentication</title>\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <style>\n          body {\n            font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            min-height: 100vh;\n            margin: 0;\n            background-color: #f5f5f5;\n          }\n          .container {\n            text-align: center;\n            padding: 2rem;\n            background: white;\n            border-radius: 8px;\n            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n          }\n          h1 {\n            color: #333;\n            margin-bottom: 1.5rem;\n          }\n          .button {\n            display: inline-block;\n            background-color: #4285f4;\n            color: white;\n            padding: 12px 24px;\n            border-radius: 4px;\n            text-decoration: none;\n            font-weight: 500;\n            transition: background-color 0.2s;\n          }\n          .button:hover {\n            background-color: #357abd;\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"container\">\n          <h1>Google Authentication</h1>\n          <a href=\"${authUrl}\" class=\"button\">Continue with Google</a>\n        </div>\n      </body>\n    </html>\n  `;\n\n  return new Response(html, {\n    headers: {\n      'Content-Type': 'text/html;charset=UTF-8',\n      ...responseHeaders\n    },\n  });\n}\n\n/**\n * Google OAuth \uCF5C\uBC31 \uC5D4\uB4DC\uD3EC\uC778\uD2B8\n * GET /oauth/google/callback\n */\nexport async function handleGoogleOAuthCallback(request, env, responseHeaders = {}) {\n  // \u2705 I: Input \u2192 \uC0AC\uC6A9\uC790 \uC694\uCCAD \uAC10\uC9C0 \uBC0F \uBA54\uD0C0 \uCCB4\uD06C\n  const headers = request.headers;\n  const userAgent = headers.get(\"User-Agent\") || \"\";\n  const requestId = headers.get(\"X-Request-ID\") || crypto.randomUUID();\n  const referer = headers.get(\"Referer\") || \"\";\n  const clientIp = headers.get(\"CF-Connecting-IP\") || \"\";\n\n  // \uAE30\uBCF8 \uBA54\uD0C0\uB370\uC774\uD130\n  const meta = {\n    requestId,\n    clientIp,\n    userAgent,\n    referer\n  };\n\n  // \uB8E8\uD504 \uC704\uD5D8 \uD310\uB2E8\n  if (referer.includes(\"aivelle.com\") || userAgent.includes(\"Aivelle-Agent\")) {\n    logger.warn(\"Loop detected in Google OAuth callback\", {\n      ...meta,\n      reason: \"loop_detected\"\n    });\n    return new Response(\"Loop detected and blocked\", { \n      status: 429,\n      headers: {\n        \"X-Error-Type\": \"loop_detected\",\n        \"Retry-After\": \"60\"\n      }\n    });\n  }\n\n  // \u2705 V: Validate \u2192 \uC694\uCCAD \uAE4A\uC774, \uBC18\uBCF5 \uC5EC\uBD80 \uAC80\uC0AC\n  const depth = Number(headers.get(\"X-Depth\") || \"0\");\n  if (depth > 3) {\n    logger.warn(\"Request depth exceeded in Google OAuth callback\", {\n      ...meta,\n      depth,\n      reason: \"depth_exceeded\"\n    });\n    return new Response(\"Request depth limit exceeded\", { \n      status: 400,\n      headers: { \"X-Error-Type\": \"depth_exceeded\" }\n    });\n  }\n\n  // \u2705 L: Log & Launch \u2192 \uC694\uCCAD \uAE30\uB85D\n  logger.apiRequest(\"GET\", \"/oauth/google/callback\", meta);\n\n  // \uC2E4\uC81C OAuth \uCF5C\uBC31 \uCC98\uB9AC \uB85C\uC9C1\n  const url = new URL(request.url);\n  const code = url.searchParams.get('code');\n  const state = url.searchParams.get('state');\n  const error = url.searchParams.get('error');\n\n  // Handle error from Google\n  if (error) {\n    logger.error(`[OAuth Error] ${requestId} Google error: ${error}`, meta);\n    return createOAuthErrorResponse(`Authentication Error: ${error}`);\n  }\n\n  if (!code) {\n    logger.warn(`[OAuth Error] ${requestId} Missing code`, meta);\n    return createOAuthErrorResponse('Authorization code is missing');\n  }\n\n  // Verify state parameter to prevent CSRF attacks\n  const isValidState = await verifyOAuthState(state, env);\n  if (!isValidState) {\n    logger.warn(`[OAuth Error] ${requestId} Invalid state`, meta);\n    return createOAuthErrorResponse('Invalid state parameter');\n  }\n  \n  const baseUrl = `${url.protocol}//${url.host}`;\n  const redirectUri = `${baseUrl}/oauth/google/callback`;\n\n  try {\n    // Exchange code for tokens with retry logic\n    let tokenData;\n    for (let attempt = 1; attempt <= 3; attempt++) {\n      try {\n        const tokenRes = await fetch('https://oauth2.googleapis.com/token', {\n          method: 'POST',\n          headers: { \n            'Content-Type': 'application/x-www-form-urlencoded',\n            'User-Agent': 'Aivelle-OAuth-Client/1.0'\n          },\n          body: new URLSearchParams({\n            code,\n            client_id: env.GOOGLE_CLIENT_ID,\n            client_secret: env.GOOGLE_CLIENT_SECRET,\n            redirect_uri: redirectUri,\n            grant_type: 'authorization_code'\n          })\n        });\n\n        if (!tokenRes.ok) {\n          const errorData = await tokenRes.text();\n          throw new Error(`Token exchange failed: ${errorData}`);\n        }\n\n        tokenData = await tokenRes.json();\n        break;\n      } catch (error) {\n        if (attempt === 3) throw error;\n        await new Promise(resolve => setTimeout(resolve, 1000 * attempt));\n      }\n    }\n\n    // Get user info with retry logic\n    let userInfo;\n    for (let attempt = 1; attempt <= 3; attempt++) {\n      try {\n        const userInfoRes = await fetch('https://www.googleapis.com/oauth2/v2/userinfo', {\n          headers: {\n            'Authorization': `Bearer ${tokenData.access_token}`,\n            'User-Agent': 'Aivelle-OAuth-Client/1.0'\n          }\n        });\n\n        if (!userInfoRes.ok) {\n          throw new Error(`Failed to fetch user info: ${userInfoRes.status}`);\n        }\n\n        userInfo = await userInfoRes.json();\n        break;\n      } catch (error) {\n        if (attempt === 3) throw error;\n        await new Promise(resolve => setTimeout(resolve, 1000 * attempt));\n      }\n    }\n\n    const userId = userInfo.email || userInfo.id;\n\n    // Save OAuth data with retry logic\n    let saveAttempt = 0;\n    while (saveAttempt < 3) {\n      try {\n        await saveUserOAuthData(userId, {\n          provider: 'google',\n          access_token: tokenData.access_token,\n          refresh_token: tokenData.refresh_token,\n          expires_in: tokenData.expires_in,\n          scope: tokenData.scope,\n          email: userInfo.email,\n          last_auth: new Date().toISOString()\n        }, env);\n        break;\n      } catch (error) {\n        saveAttempt++;\n        if (saveAttempt === 3) throw error;\n        await new Promise(resolve => setTimeout(resolve, 1000 * saveAttempt));\n      }\n    }\n\n    logger.info(`[OAuth Success] ${requestId} User ${userId} authenticated`, {\n      ...meta,\n      user_id: userId,\n      email: userInfo.email\n    });\n\n    // Return success page with tracking headers\n    const response = createOAuthSuccessResponse('Successfully authenticated with Google!');\n    response.headers = new Headers({\n      ...response.headers,\n      ...responseHeaders\n    });\n    return response;\n\n  } catch (error) {\n    logger.error(`[OAuth Error] ${requestId} Authentication failed: ${error.message}`, {\n      ...meta,\n      error: error.message,\n      stack: error.stack\n    });\n    return createOAuthErrorResponse(`Authentication failed: ${error.message}`, 500);\n  }\n} ", "/**\n * Notion OAuth \uC778\uC99D \uB9AC\uB514\uB809\uC158 \uC5D4\uB4DC\uD3EC\uC778\uD2B8\n * GET /oauth/notion\n */\nimport { saveOAuthState, verifyOAuthState, saveUserOAuthData, createOAuthErrorResponse, createOAuthSuccessResponse } from '../utils/oauth.js';\nimport logger from '../utils/logger.js';\n\nexport async function handleNotionOAuthRequest(request, env, responseHeaders = {}) {\n  // \u2705 I: Input \u2192 \uC0AC\uC6A9\uC790 \uC694\uCCAD \uAC10\uC9C0 \uBC0F \uBA54\uD0C0 \uCCB4\uD06C\n  const headers = request.headers;\n  const userAgent = headers.get(\"User-Agent\") || \"\";\n  const requestId = headers.get(\"X-Request-ID\") || crypto.randomUUID();\n  const referer = headers.get(\"Referer\") || \"\";\n  const clientIp = headers.get(\"CF-Connecting-IP\") || \"\";\n\n  // \uAE30\uBCF8 \uBA54\uD0C0\uB370\uC774\uD130\n  const meta = {\n    requestId,\n    clientIp,\n    userAgent,\n    referer\n  };\n\n  // \uB8E8\uD504 \uC704\uD5D8 \uD310\uB2E8\n  if (referer.includes(\"aivelle.com\") || userAgent.includes(\"Aivelle-Agent\")) {\n    logger.warn(\"Loop detected in Notion OAuth request\", {\n      ...meta,\n      reason: \"loop_detected\"\n    });\n    return new Response(\"Loop detected and blocked\", { \n      status: 429,\n      headers: {\n        \"X-Error-Type\": \"loop_detected\",\n        \"Retry-After\": \"60\"\n      }\n    });\n  }\n\n  // \u2705 V: Validate \u2192 \uC694\uCCAD \uAE4A\uC774, \uBC18\uBCF5 \uC5EC\uBD80 \uAC80\uC0AC\n  const depth = Number(headers.get(\"X-Depth\") || \"0\");\n  if (depth > 3) {\n    logger.warn(\"Request depth exceeded in Notion OAuth\", {\n      ...meta,\n      depth,\n      reason: \"depth_exceeded\"\n    });\n    return new Response(\"Request depth limit exceeded\", { \n      status: 400,\n      headers: { \"X-Error-Type\": \"depth_exceeded\" }\n    });\n  }\n\n  // \u2705 L: Log & Launch \u2192 \uC694\uCCAD \uAE30\uB85D\n  logger.apiRequest(\"GET\", \"/oauth/notion\", meta);\n\n  // \uC2E4\uC81C OAuth \uCC98\uB9AC \uB85C\uC9C1\n  const clientId = env.NOTION_CLIENT_ID;\n  if (!clientId) {\n    logger.error(\"Notion OAuth client ID is not configured\", meta);\n    return createOAuthErrorResponse('Notion OAuth client ID is not configured', 500);\n  }\n\n  const url = new URL(request.url);\n  const baseUrl = `${url.protocol}//${url.host}`;\n  const redirectUri = `${baseUrl}/oauth/notion/callback`;\n  \n  // Generate and save state for CSRF protection\n  const state = crypto.randomUUID();\n  await saveOAuthState(state, env);\n  \n  const authUrl = `https://api.notion.com/v1/oauth/authorize?client_id=${clientId}&redirect_uri=${encodeURIComponent(redirectUri)}&response_type=code&owner=user&state=${state}`;\n  \n  // Return HTML response with tracking headers\n  const html = `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <title>Notion OAuth Authentication</title>\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <style>\n          body {\n            font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            min-height: 100vh;\n            margin: 0;\n            background-color: #f5f5f5;\n          }\n          .container {\n            text-align: center;\n            padding: 2rem;\n            background: white;\n            border-radius: 8px;\n            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n          }\n          h1 {\n            color: #333;\n            margin-bottom: 1.5rem;\n          }\n          .button {\n            display: inline-block;\n            background-color: #000000;\n            color: white;\n            padding: 12px 24px;\n            border-radius: 4px;\n            text-decoration: none;\n            font-weight: 500;\n            transition: background-color 0.2s;\n          }\n          .button:hover {\n            background-color: #333333;\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"container\">\n          <h1>Notion Authentication</h1>\n          <a href=\"${authUrl}\" class=\"button\">Continue with Notion</a>\n        </div>\n      </body>\n    </html>\n  `;\n\n  return new Response(html, {\n    headers: {\n      'Content-Type': 'text/html;charset=UTF-8',\n      ...responseHeaders\n    },\n  });\n}\n\n/**\n * Notion OAuth \uCF5C\uBC31 \uC5D4\uB4DC\uD3EC\uC778\uD2B8\n * GET /oauth/notion/callback\n */\nexport async function handleNotionOAuthCallback(request, env, responseHeaders = {}) {\n  // \u2705 I: Input \u2192 \uC0AC\uC6A9\uC790 \uC694\uCCAD \uAC10\uC9C0 \uBC0F \uBA54\uD0C0 \uCCB4\uD06C\n  const headers = request.headers;\n  const userAgent = headers.get(\"User-Agent\") || \"\";\n  const requestId = headers.get(\"X-Request-ID\") || crypto.randomUUID();\n  const referer = headers.get(\"Referer\") || \"\";\n  const clientIp = headers.get(\"CF-Connecting-IP\") || \"\";\n\n  // \uAE30\uBCF8 \uBA54\uD0C0\uB370\uC774\uD130\n  const meta = {\n    requestId,\n    clientIp,\n    userAgent,\n    referer\n  };\n\n  // \uB8E8\uD504 \uC704\uD5D8 \uD310\uB2E8\n  if (referer.includes(\"aivelle.com\") || userAgent.includes(\"Aivelle-Agent\")) {\n    logger.warn(\"Loop detected in Notion OAuth callback\", {\n      ...meta,\n      reason: \"loop_detected\"\n    });\n    return new Response(\"Loop detected and blocked\", { \n      status: 429,\n      headers: {\n        \"X-Error-Type\": \"loop_detected\",\n        \"Retry-After\": \"60\"\n      }\n    });\n  }\n\n  // \u2705 V: Validate \u2192 \uC694\uCCAD \uAE4A\uC774, \uBC18\uBCF5 \uC5EC\uBD80 \uAC80\uC0AC\n  const depth = Number(headers.get(\"X-Depth\") || \"0\");\n  if (depth > 3) {\n    logger.warn(\"Request depth exceeded in Notion OAuth callback\", {\n      ...meta,\n      depth,\n      reason: \"depth_exceeded\"\n    });\n    return new Response(\"Request depth limit exceeded\", { \n      status: 400,\n      headers: { \"X-Error-Type\": \"depth_exceeded\" }\n    });\n  }\n\n  // \u2705 L: Log & Launch \u2192 \uC694\uCCAD \uAE30\uB85D\n  logger.apiRequest(\"GET\", \"/oauth/notion/callback\", meta);\n\n  // \uC2E4\uC81C OAuth \uCF5C\uBC31 \uCC98\uB9AC \uB85C\uC9C1\n  const url = new URL(request.url);\n  const code = url.searchParams.get('code');\n  const state = url.searchParams.get('state');\n  const error = url.searchParams.get('error');\n\n  // Handle error from Notion\n  if (error) {\n    logger.error(`[OAuth Error] ${requestId} Notion error: ${error}`, meta);\n    return createOAuthErrorResponse(`Authentication Error: ${error}`);\n  }\n\n  if (!code) {\n    logger.warn(`[OAuth Error] ${requestId} Missing code`, meta);\n    return createOAuthErrorResponse('Authorization code is missing');\n  }\n\n  // Verify state parameter to prevent CSRF attacks\n  const isValidState = await verifyOAuthState(state, env);\n  if (!isValidState) {\n    logger.warn(`[OAuth Error] ${requestId} Invalid state`, meta);\n    return createOAuthErrorResponse('Invalid state parameter');\n  }\n  \n  const baseUrl = `${url.protocol}//${url.host}`;\n  const redirectUri = `${baseUrl}/oauth/notion/callback`;\n\n  try {\n    // Exchange code for tokens with retry logic\n    let tokenData;\n    for (let attempt = 1; attempt <= 3; attempt++) {\n      try {\n        const tokenRes = await fetch('https://api.notion.com/v1/oauth/token', {\n          method: 'POST',\n          headers: {\n            'Authorization': `Basic ${btoa(`${env.NOTION_CLIENT_ID}:${env.NOTION_CLIENT_SECRET}`)}`,\n            'Content-Type': 'application/json',\n            'Notion-Version': '2022-06-28',\n            'User-Agent': 'Aivelle-OAuth-Client/1.0'\n          },\n          body: JSON.stringify({\n            grant_type: 'authorization_code',\n            code,\n            redirect_uri: redirectUri\n          })\n        });\n\n        if (!tokenRes.ok) {\n          const errorData = await tokenRes.text();\n          throw new Error(`Token exchange failed: ${errorData}`);\n        }\n\n        tokenData = await tokenRes.json();\n        break;\n      } catch (error) {\n        if (attempt === 3) throw error;\n        await new Promise(resolve => setTimeout(resolve, 1000 * attempt));\n      }\n    }\n\n    // Get workspace info\n    const workspaceId = tokenData.workspace_id;\n    const botId = tokenData.bot_id;\n    const accessToken = tokenData.access_token;\n\n    // Save OAuth data with retry logic\n    let saveAttempt = 0;\n    while (saveAttempt < 3) {\n      try {\n        await saveUserOAuthData(workspaceId, {\n          provider: 'notion',\n          access_token: accessToken,\n          bot_id: botId,\n          workspace_id: workspaceId,\n          owner: tokenData.owner,\n          workspace_name: tokenData.workspace_name,\n          workspace_icon: tokenData.workspace_icon,\n          last_auth: new Date().toISOString()\n        }, env);\n        break;\n      } catch (error) {\n        saveAttempt++;\n        if (saveAttempt === 3) throw error;\n        await new Promise(resolve => setTimeout(resolve, 1000 * saveAttempt));\n      }\n    }\n\n    logger.info(`[OAuth Success] ${requestId} Workspace ${workspaceId} authenticated`, {\n      ...meta,\n      workspace_id: workspaceId\n    });\n\n    // Return success page with tracking headers\n    const response = createOAuthSuccessResponse('Successfully authenticated with Notion!');\n    response.headers = new Headers({\n      ...response.headers,\n      ...responseHeaders\n    });\n    return response;\n\n  } catch (error) {\n    logger.error(`[OAuth Error] ${requestId} Authentication failed: ${error.message}`, {\n      ...meta,\n      error: error.message,\n      stack: error.stack\n    });\n    return createOAuthErrorResponse(`Authentication failed: ${error.message}`, 500);\n  }\n} ", "// src/index.js\n\nimport { workflows, runWorkflow } from \"./workflow-engine.js\";\nimport promptRouter from \"../configs/prompt-router.json\" assert { type: 'json' };\nimport { runWorkflowFromPrompt } from \"./run-workflow.js\";\nimport { getIntentFromPrompt } from \"./utils/getIntentFromPrompt.js\";\nimport { handleGoogleOAuthRequest, handleGoogleOAuthCallback } from './oauth/google.js';\nimport { handleNotionOAuthRequest, handleNotionOAuthCallback } from './oauth/notion.js';\nimport logger from './utils/logger.js';\n\nexport default {\n  async fetch(request, env) {\n    // \u2705 I: Input \u2192 \uC694\uCCAD \uBA54\uD0C0\uB370\uC774\uD130 \uCCB4\uD06C\n    const headers = request.headers;\n    const userAgent = headers.get(\"User-Agent\") || \"\";\n    const requestId = headers.get(\"X-Request-ID\") || crypto.randomUUID();\n    const referer = headers.get(\"Referer\") || \"\";\n    const clientIp = request.headers.get(\"CF-Connecting-IP\") || \"\";\n\n    // \uAE30\uBCF8 \uBA54\uD0C0\uB370\uC774\uD130\n    const meta = {\n      requestId,\n      clientIp,\n      userAgent,\n      referer\n    };\n\n    // \uBB34\uD55C \uB8E8\uD504 \uAC10\uC9C0 \uBC0F \uCC28\uB2E8\n    if (referer.includes(\"aivelle.com\") || userAgent.includes(\"Aivelle-Agent\")) {\n      logger.warn(\"Loop detected and blocked\", {\n        ...meta,\n        reason: \"loop_detected\"\n      });\n      return new Response(\"Loop detected and blocked\", { \n        status: 429,\n        headers: {\n          \"X-Error-Type\": \"loop_detected\",\n          \"Retry-After\": \"60\"\n        }\n      });\n    }\n\n    // \u2705 V: Validate \u2192 \uC694\uCCAD \uAE4A\uC774, \uBC18\uBCF5 \uC5EC\uBD80 \uAC80\uC0AC\n    const depth = Number(headers.get(\"X-Depth\") || \"0\");\n    if (depth > 3) {\n      logger.warn(\"Request depth limit exceeded\", {\n        ...meta,\n        depth,\n        reason: \"depth_exceeded\"\n      });\n      return new Response(\"Request depth limit exceeded\", { \n        status: 400,\n        headers: { \"X-Error-Type\": \"depth_exceeded\" }\n      });\n    }\n\n    // \u2705 L: Log & Launch \u2192 \uC694\uCCAD \uAE30\uB85D\n    logger.apiRequest(request.method, new URL(request.url).pathname, meta);\n\n    // Add tracking headers for subsequent requests\n    const responseHeaders = {\n      \"X-Request-ID\": requestId,\n      \"X-Depth\": (depth + 1).toString(),\n      \"X-Processor\": \"aivelle-worker\"\n    };\n\n    const url = new URL(request.url);\n    const pathname = url.pathname;\n\n    try {\n      // OAuth routes\n      if (pathname === '/oauth/google') {\n        return await handleGoogleOAuthRequest(request, env, responseHeaders);\n      } \n      if (pathname === '/oauth/google/callback') {\n        return await handleGoogleOAuthCallback(request, env, responseHeaders);\n      }\n      if (pathname === '/oauth/notion') {\n        return await handleNotionOAuthRequest(request, env, responseHeaders);\n      }\n      if (pathname === '/oauth/notion/callback') {\n        return await handleNotionOAuthCallback(request, env, responseHeaders);\n      }\n\n      // API routes\n      if (pathname === \"/api/route-workflow\" && request.method === \"POST\") {\n        try {\n          const body = await request.json();\n          const intent = body.intent;\n          const route = promptRouter.routes.find(r => r.intent === intent);\n          if (!route) {\n            logger.warn(\"No workflow mapped for intent\", {\n              ...meta,\n              intent,\n              reason: \"workflow_not_found\"\n            });\n            return new Response(`\u274C No workflow mapped for intent: ${intent}`, { \n              status: 404,\n              headers: responseHeaders\n            });\n          }\n          const workflow = workflows[route.workflow];\n          if (!workflow) {\n            logger.warn(\"Workflow not found\", {\n              ...meta,\n              workflow: route.workflow,\n              reason: \"workflow_not_found\"\n            });\n            return new Response(`\u274C Workflow not found: ${route.workflow}`, { \n              status: 404,\n              headers: responseHeaders\n            });\n          }\n          const context = body.context || {};\n          \n          // \uC6CC\uD06C\uD50C\uB85C\uC6B0 \uC2E4\uD589 \uC2DC\uAC04 \uCE21\uC815\n          const startTime = performance.now();\n          await runWorkflow(workflow, workflow.trigger, context);\n          const endTime = performance.now();\n          \n          logger.logMetric(\"workflow_execution_time\", endTime - startTime, {\n            ...meta,\n            workflow: route.workflow\n          });\n\n          return new Response(`Workflow '${route.workflow}' executed for intent '${intent}'.`, { \n            status: 200,\n            headers: responseHeaders\n          });\n        } catch (err) {\n          logger.error(\"Workflow execution error\", {\n            ...meta,\n            error: err.message,\n            stack: err.stack\n          });\n          return new Response(`\u274C Error: ${err.message}`, { \n            status: 500,\n            headers: responseHeaders\n          });\n        }\n      }\n\n      // Handle POST requests to the root path\n      if (pathname === \"/\" && request.method === \"POST\") {\n        try {\n          const body = await request.json();\n          const prompt = body.prompt || \"\";\n          const intent = getIntentFromPrompt(prompt);\n\n          if (!intent) {\n            logger.warn(\"No matching intent found\", {\n              ...meta,\n              prompt,\n              reason: \"intent_not_found\"\n            });\n            return new Response(\"\u274C No matching intent found.\", { \n              status: 400,\n              headers: responseHeaders\n            });\n          }\n\n          const startTime = performance.now();\n          const result = await runWorkflow(intent, prompt);\n          const endTime = performance.now();\n\n          logger.logMetric(\"intent_execution_time\", endTime - startTime, {\n            ...meta,\n            intent\n          });\n\n          return new Response(JSON.stringify(result), {\n            status: 200,\n            headers: {\n              ...responseHeaders,\n              \"Content-Type\": \"application/json\"\n            }\n          });\n        } catch (err) {\n          logger.error(\"Root path execution error\", {\n            ...meta,\n            error: err.message,\n            stack: err.stack\n          });\n          return new Response(`\u274C Error: ${err.message}`, { \n            status: 500,\n            headers: responseHeaders\n          });\n        }\n      }\n\n      // Default response for unmatched routes\n      logger.warn(\"Route not found\", {\n        ...meta,\n        path: pathname,\n        reason: \"route_not_found\"\n      });\n      return new Response(\"Not Found\", { \n        status: 404,\n        headers: responseHeaders\n      });\n    } catch (err) {\n      logger.fatal(\"Unhandled error\", {\n        ...meta,\n        error: err.message,\n        stack: err.stack\n      });\n      return new Response(\"Internal Server Error\", { \n        status: 500,\n        headers: responseHeaders\n      });\n    }\n  }\n};\n\n// Cloudflare Workers \uC2A4\uD0C0\uC77C \uB77C\uC6B0\uD305\naddEventListener('fetch', event => {\n  event.respondWith(\n    handleRequest(event.request, event.env).catch(err => {\n      logger.fatal(\"Unhandled request error\", {\n        error: err.message,\n        stack: err.stack\n      });\n      return new Response(\"Internal Server Error\", { status: 500 });\n    })\n  );\n});\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"/Users/kaminchung/Documents/ personal_assistant_agent/src/index.js\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"/usr/local/lib/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts\";\n\n\t\t\t\texport * from \"/Users/kaminchung/Documents/ personal_assistant_agent/src/index.js\";\n\t\t\t\tconst MIDDLEWARE_TEST_INJECT = \"__INJECT_FOR_TESTING_WRANGLER_MIDDLEWARE__\";\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"/Users/kaminchung/Documents/ personal_assistant_agent/.wrangler/tmp/bundle-IjqVcK/middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"/usr/local/lib/node_modules/wrangler/templates/middleware/common.ts\";\nimport type { WorkerEntrypointConstructor } from \"/Users/kaminchung/Documents/ personal_assistant_agent/.wrangler/tmp/bundle-IjqVcK/middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"/Users/kaminchung/Documents/ personal_assistant_agent/.wrangler/tmp/bundle-IjqVcK/middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": "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",
  "names": ["run", "run", "run", "run", "run", "run", "run", "run", "run", "run", "run", "run", "error", "error"]
}
